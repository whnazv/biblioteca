<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
<title>Mi Biblioteca</title>

<!-- Favicon -->
<link rel="icon" type="image/png" th:href="@{/fondo_registro.jpg}">

    <title>PolÃ­tica de privacidad</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" th:href="@{/css/layaout.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/index.css}">
    <!-- Enlace al CSS para Spring Boot con Thymeleaf-->
    <link rel="stylesheet" href="/src/main/resources/static/css/layaout.css" >
    <link rel="stylesheet" href="/src/main/resources/static/css/list.css" >
</head>
<body >

<header>
    <h1>Mi Biblioteca</h1>
    <p>Explora los libros disponibles</p>
</header>

<!-- Barra de navegaciÃ³n -->
<nav>
    <a th:href="@{/}">Inicio</a>
    <a th:href="@{/web/books}">Libros</a>
    <a th:href="@{/web/auth/perfil}">Perfil</a>
    <a th:href="@{/web/auth/register}">Registrarse</a>
     
</nav>

<main class="container">

    <!-- TITULO PRINCIPAL -->
    <section>
        <h1>ğŸ“˜ Proyecto Biblioteca â€” DocumentaciÃ³n General</h1>
        <p>
            Esta aplicaciÃ³n es un sistema completo de gestiÃ³n de biblioteca desarrollado siguiendo la
            <strong>Arquitectura Hexagonal</strong> e implementado con Spring Boot, Thymeleaf, JPA,
            JWT, Docker y MySQL.
            AquÃ­ se explica cÃ³mo estÃ¡ organizado el proyecto, las tecnologÃ­as utilizadas, la API REST,
            su seguridad, y cÃ³mo interactÃºan todos los mÃ³dulos.
        </p>
    </section>

    <!-- SECCION DE TECNOLOGIAS -->
    <section>
        <h2>ğŸ§© TecnologÃ­as Utilizadas</h2>
        <ul>
            <li><strong>Spring Boot 3</strong> â€” Motor principal del backend.</li>
            <li><strong>Spring Web</strong> â€” Controladores REST.</li>
            <li><strong>Spring Security 6</strong> â€” ProtecciÃ³n de rutas y autenticaciÃ³n.</li>
            <li><strong>JJWT</strong> â€” GeneraciÃ³n y validaciÃ³n de tokens JWT.</li>
            <li><strong>Spring Data JPA</strong> â€” Acceso a base de datos y persistencia.</li>
            <li><strong>MySQL 8</strong> â€” Base de datos relacional.</li>
            <li><strong>Docker</strong> â€” Contenedor para MySQL.</li>
            <li><strong>Thymeleaf</strong> â€” Vistas HTML para la web pÃºblica y privada.</li>
            <li><strong>MapStruct</strong> â€” ConversiÃ³n entre entidades, DTOs y modelos de dominio.</li>
            <li><strong>SpringDoc / Swagger UI</strong> â€” DocumentaciÃ³n interactiva de la API.</li>
        </ul>
    </section>

    <!-- ARQUITECTURA -->
    <section>
        <h2>ğŸ› Arquitectura Hexagonal</h2>

        <p>
            El proyecto adopta la Arquitectura Hexagonal (Ports & Adapters).
            Esto permite una separaciÃ³n clara entre:
        </p>

        <ul>
            <li><strong>Dominio</strong>: reglas de negocio puras.</li>
            <li><strong>AplicaciÃ³n (Use Cases)</strong>: define quÃ© se puede hacer.</li>
            <li><strong>Infraestructura</strong>: controladores REST, JPA, seguridad, DTOs, mappersâ€¦</li>
        </ul>

        <h3>ğŸ“ Estructura real del proyecto</h3>
        <pre>
src/main/java/onion/whnazv/biblioteca/
    â”œâ”€â”€ application
    â”‚     â”œâ”€â”€ port (in/out)
    â”‚     â””â”€â”€ usecase (lÃ³gica de negocio)
    â”œâ”€â”€ domain
    â”‚     â”œâ”€â”€ model (Book, User, Saleâ€¦)
    â”‚     â””â”€â”€ exception
    â”œâ”€â”€ infrastructure
    â”‚     â”œâ”€â”€ adapter
    â”‚     â”‚     â”œâ”€â”€ in (REST y Web MVC)
    â”‚     â”‚     â””â”€â”€ out (Persistencia JPA)
    â”‚     â”œâ”€â”€ mapper (DTO y Entity)
    â”‚     â””â”€â”€ security (JWT + filtros)
    â””â”€â”€ BibliotecaApplication.java
        </pre>

        <h3>ğŸ§  Principio fundamental</h3>
        <p>
            El dominio NO depende de infraestructura.
            Esto significa que la lÃ³gica de negocio puede sobrevivir incluso si cambias la base de datos,
            los controladores REST o la interfaz web.
        </p>
    </section>

    <!-- BASE DE DATOS Y DOCKER -->
    <section>
        <h2>ğŸ¬ Base de Datos y Docker</h2>

        <h3>Docker Compose utilizado:</h3>
        <pre>
services:
  mysql:
    image: mysql:8.0
    container_name: mysql_proyecto
    environment:
      MYSQL_DATABASE: proyecto_11
      MYSQL_USER: nombre_1
      MYSQL_PASSWORD: contra_1
      MYSQL_ROOT_PASSWORD: contra_1
    ports:
      - "3306:3306"
    volumes:
      - ./mysql_data:/var/lib/mysql
        </pre>

        <p>La aplicaciÃ³n se conecta mediante:</p>

        <pre>
spring.datasource.url=jdbc:mysql://localhost:3306/proyecto_11
spring.datasource.username=nombre_1
spring.datasource.password=contra_1
        </pre>

        <p>
            El esquema se genera automÃ¡ticamente gracias a:
        </p>

        <pre>spring.jpa.hibernate.ddl-auto=update</pre>
    </section>

    <!-- JWT -->
    <section>
        <h2>ğŸ” Seguridad y AutenticaciÃ³n (JWT)</h2>
        <p>
            La autenticaciÃ³n se realiza mediante JSON Web Tokens.
            El flujo es el siguiente:
        </p>

        <ol>
            <li>El usuario envÃ­a sus credenciales a <strong>/api/v1/public/auth/login</strong>.</li>
            <li>Spring Security verifica email + contraseÃ±a.</li>
            <li>Se genera un JWT firmado.</li>
            <li>El usuario lo envÃ­a en cada peticiÃ³n privada:
                <pre>Authorization: Bearer &lt;token&gt;</pre>
            </li>
            <li>Un filtro (JwtAuthenticationFilter) valida el token.</li>
        </ol>

        <h3>Ejemplo de login:</h3>
        <pre>
POST /api/v1/public/auth/login
Content-Type: application/json

{
  "email": "admin@example.com",
  "password": "1234"
}
        </pre>

        <h3>Respuesta (token JWT):</h3>
        <pre>
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI..."
}
        </pre>
    </section>

    <!-- API REST -->
    <section>
        <h2>ğŸŒ API REST</h2>
        <p>
            La API sigue el estilo REST y devuelve siempre respuestas JSON.
            Se divide en endpoints pÃºblicos, de cliente y de administrador.
        </p>

        <!-- PUBLIC -->
        <h3>ğŸŒ Endpoints PÃºblicos</h3>
        <ul>
            <li><strong>POST /api/v1/public/auth/login</strong> â€” Devuelve token JWT.</li>
        </ul>

        <!-- ADMIN -->
        <h3>ğŸ›¡ Endpoints Administrador (requieren ROLE_ADMIN)</h3>

        <h4>ğŸ“„ Ventas</h4>
        <ul>
            <li><strong>GET /api/v1/private/admin/sales</strong> â€” Lista todas las ventas.</li>
            <li><strong>GET /api/v1/private/admin/sales/{id}</strong> â€” Detalles de una venta.</li>
            <li><strong>POST /api/v1/private/admin/sales?userId=ID</strong> â€” Crea venta.</li>
            <li><strong>PUT /api/v1/private/admin/sales/{id}?userId=ID</strong> â€” Actualiza venta.</li>
            <li><strong>DELETE /api/v1/private/admin/sales/{id}</strong> â€” Elimina venta.</li>
        </ul>

        <h4>ğŸ“š Libros</h4>
        <ul>
            <li><strong>GET /api/books</strong></li>
            <li><strong>GET /api/books/{id}</strong></li>
            <li><strong>POST /api/books</strong></li>
            <li><strong>PUT /api/books/{id}</strong></li>
            <li><strong>DELETE /api/books/{id}</strong></li>
        </ul>

        <!-- CLIENT -->
        <h3>ğŸ‘¤ Endpoints Cliente (requieren ROLE_CLIENT)</h3>
        <p>(Si implementados en tu proyecto)</p>
        <ul>
            <li><strong>GET /api/v1/private/client/sales</strong> â€” Ventas propias.</li>
            <li><strong>GET /api/v1/private/client/sales/{id}</strong></li>
        </ul>

        <!-- JSON -->
        <h3>ğŸ“¦ Ejemplo de respuesta JSON</h3>
        <pre>
{
  "id": 1,
  "title": "El Quijote",
  "author": "Miguel de Cervantes",
  "price": 19.99,
  "stock": 12
}
        </pre>
    </section>

    <!-- SWAGGER -->
    <section>
        <h2>ğŸ“‘ Swagger UI</h2>
        <p>Puedes explorar y probar la API de forma interactiva aquÃ­:</p>

        <p>
            ğŸ‘‰ <a href="http://localhost:8080/swagger-ui.html" target="_blank">
            Abrir documentaciÃ³n Swagger
        </a>
        </p>
    </section>

    <!-- FLUJO COMPLETO -->
    <section>
        <h2>ğŸ”„ Flujo completo de una operaciÃ³n</h2>
        <ol>
            <li>El cliente envÃ­a una peticiÃ³n REST al controlador.</li>
            <li>El controlador (adapter IN) convierte DTO â†’ dominio.</li>
            <li>El caso de uso ejecuta la lÃ³gica de negocio.</li>
            <li>El puerto OUT llama al adapter de persistencia.</li>
            <li>El adapter usa JPA para guardar en MySQL.</li>
            <li>Se devuelve la respuesta en formato JSON.</li>
        </ol>
    </section>

    <!-- NOTAS -->
    <section>
        <h2>ğŸ“ Notas finales</h2>
        <p>
            Esta documentaciÃ³n resume la estructura interna, API y funcionamiento del proyecto.
            Su arquitectura modular permite escalar, aÃ±adir nuevas funcionalidades y
            modificar la base de datos o la interfaz sin afectar al nÃºcleo de negocio.
        </p>
    </section>

</main>



<footer>
    <p>&copy; 2025 Mi Biblioteca. Todos los derechos reservados.</p>
    <p>
        <a th:href="@{/informacionWeb}">InformaciÃ³n Web</a> |
        <a th:href="@{/informacionApi}">InformaciÃ³n API</a> |
        <a href="https://github.com/whnazv">GitHub</a>
    </p>
</footer>
</body>
</html>
